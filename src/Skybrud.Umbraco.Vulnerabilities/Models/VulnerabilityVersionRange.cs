
using System;

namespace Skybrud.Umbraco.Vulnerabilities.Models {

    public class VulnerabilityVersionRange {

        public bool FromInclusive { get; set; }

        public Version From { get; set; }

        public Version To { get; set; }

        public bool ToInclusive { get; set; }

        public VulnerabilityVersionRange() { }

        public VulnerabilityVersionRange(Version from, Version to) {
            From = from;
            FromInclusive = true;
            To = to;
            ToInclusive = true;
        }

        public VulnerabilityVersionRange(Version version) {
            From = version;
            FromInclusive = true;
            To = version;
            ToInclusive = true;
        }

        public VulnerabilityVersionRange(Version from, bool fromInclusive, Version to, bool toInclusive) {
            From = from;
            FromInclusive = fromInclusive;
            To = to;
            ToInclusive = toInclusive;
        }

        public bool IsAffected(Version version) {
            if (FromInclusive && From == version) return true;
            if (ToInclusive && To == version) return true;
            return version > From && version < To;
        }

    }

}