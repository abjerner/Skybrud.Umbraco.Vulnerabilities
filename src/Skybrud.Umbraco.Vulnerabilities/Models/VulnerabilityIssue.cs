using System;
using System.Linq;
using System.Reflection;
using Newtonsoft.Json;

namespace Skybrud.Umbraco.Vulnerabilities.Models {

    public class VulnerabilityIssue {

        [JsonProperty("type")]
        public string Type { get; set; }

        [JsonProperty("severity")]
        public string Severity { get; set; }

        [JsonProperty("date")]
        public DateTime Date { get; set; }

        [JsonProperty("name")]
        public string Name { get; set; }

        [JsonProperty("description")]
        public string Description { get; set; }

        public bool HasDescription => !String.IsNullOrWhiteSpace(Description);

        [JsonProperty("url")]
        public string Url { get; set; }

        public bool HasUrl => !String.IsNullOrWhiteSpace(Url);

        [JsonProperty("assemblies")]
        public VulnerabilityAssembly[] Assemblies { get; set; }

        public bool IsAffected(Assembly assembly) {
            return assembly != null && Assemblies != null && Assemblies.Length > 0 && Assemblies.Any(x => x.IsAffected(assembly));
        }

    }

}