using System.Linq;
using System.Reflection;
using Newtonsoft.Json;

namespace Skybrud.Umbraco.Vulnerabilities.Models {

    public class VulnerabilityFeed {

        [JsonProperty("author")]
        public VulnerabilityFeedAuthor Author { get; set; }
        
        [JsonProperty("products")]
        public VulnerabilityProduct[] Products { get; set; }

        public bool IsAffected(Assembly assembly) {
            return assembly != null && Products != null && Products.Length > 0 && Products.Any(x => x.IsAffected(assembly));
        }

    }

}