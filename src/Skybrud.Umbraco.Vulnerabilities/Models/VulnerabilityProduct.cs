using System.Linq;
using System.Reflection;
using Newtonsoft.Json;

namespace Skybrud.Umbraco.Vulnerabilities.Models {

    public class VulnerabilityProduct {

        [JsonProperty("name")]
        public string Name { get; set; }

        [JsonProperty("url")]
        public string Url { get; set; }

        [JsonProperty("issues")]
        public VulnerabilityIssue[] Issues { get; set; }

        public bool IsAffected(Assembly assembly) {
            return assembly != null && Issues != null && Issues.Length > 0 && Issues.Any(x => x.IsAffected(assembly));
        }

    }

}